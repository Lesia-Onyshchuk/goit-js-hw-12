{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export default function markup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        tags,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"li-item\">\n             <a class=\"gallery-link\" href=\"${largeImageURL}\">\n               <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"300\">\n             </a>\n               <ul class=\"image-description\">\n               <li>\n                 <h2 class=\"title\">Likes</h2>\n                 <p>${likes}</p>\n               </li>\n               <li>\n               <h2 class=\"title\">Views</h2>\n               <p>${views}</p>\n               </li>\n               <li>\n                 <h2 class=\"title\">Comments</h2>\n                 <p>${comments}</p>\n               </li>\n               <li>\n                 <h2 class=\"title\">Downloads</h2>\n                 <p>${downloads}</p>\n               </li>\n               </ul>\n       </li>`\n    )\n    .join('');\n}\n","import 'izitoast/dist/css/iziToast.min.css';\n\nimport axios from 'axios';\n\nconst API_KEY = '47418374-a80c993bb5abb784419bb47e5';\n\nexport const fetchFoo = async (info, page = 1) => {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: info,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 15,\n    page: page,\n  });\n\n  const response = await axios.get(\n    `https://pixabay.com/api/?key=${API_KEY}&q=${params}`\n  );\n  return response.data;\n};\n","import './css/loader.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport markup from './js/render-functions.js';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchFoo } from './js/pixabay-api.js';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loadBtn = document.querySelector('.load-more');\n\nlet lightbox = new SimpleLightbox('.gallery .gallery-link', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nloadBtn.setAttribute('hidden', true);\nloadBtn.style.display = 'none';\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nexport function hideLoader() {\n  loader.style.display = 'none';\n}\n\nlet value = '';\nlet currentPage = 1;\nlet perPage = 15;\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  loadBtn.hidden = true;\n  loadBtn.style.display = 'none';\n});\n\nform.addEventListener('submit', event => {\n  event.preventDefault();\n\n  currentPage = 1;\n\n  const input = event.target.elements.search;\n  value = input.value.trim();\n\n  showLoader();\n\n  if (!value) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search query!',\n      position: 'topRight',\n      backgroundColor: '#f39c12',\n      messageColor: '#ffffff',\n      messageSize: '16px',\n      titleColor: '#ffffff',\n    });\n\n    gallery.innerHTML = '';\n    hideLoader();\n    loadBtn.hidden = true;\n    loadBtn.style.display = 'none';\n\n    return;\n  } else {\n    showLoader();\n    fetchFoo(value)\n      .then(data => {\n        if (data.hits.length < perPage) {\n          loadBtn.setAttribute('hidden', true);\n          loadBtn.style.display = 'none';\n        }\n        if (data.hits.length === 0) {\n          loadBtn.setAttribute('hidden', true);\n          iziToast.error({\n            title: 'Error',\n            message:\n              'Sorry, there are no images matching your search query. Please try again!',\n            position: 'topRight',\n            backgroundColor: '#ef4040',\n            messageColor: '#ffffff',\n            messageSize: '16px',\n            titleColor: '#ffffff',\n          });\n        }\n        gallery.innerHTML = '';\n\n        gallery.insertAdjacentHTML('beforeend', markup(data.hits));\n\n        lightbox.refresh();\n      })\n      .catch(error => {\n        gallery.innerHTML = '';\n        iziToast.error({\n          title: 'Error',\n          message: `An error occurred: ${error.message}`,\n          position: 'topRight',\n          backgroundColor: '#ef4040',\n          messageColor: '#ffffff',\n          messageSize: '16px',\n          titleColor: '#ffffff',\n        });\n      })\n      .finally(() => {\n        hideLoader();\n      });\n\n    loadBtn.removeAttribute('hidden');\n    loadBtn.style.display = 'block';\n  }\n\n  form.reset();\n  return value;\n});\n\nloadBtn.addEventListener('click', async () => {\n  currentPage += 1;\n\n  try {\n    showLoader();\n    const posts = await fetchFoo(value, currentPage);\n    const totalPages = Math.ceil(posts.totalHits / perPage);\n    gallery.insertAdjacentHTML('beforeend', markup(posts.hits));\n\n    const firstCard = gallery.firstElementChild;\n    if (firstCard) {\n      const { height: cardHeight } = firstCard.getBoundingClientRect();\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n\n    if (currentPage >= totalPages) {\n      loadBtn.setAttribute('hidden', true);\n      loadBtn.style.display = 'none';\n      return iziToast.error({\n        title: 'Warning',\n        message: \"We're sorry, there are no more posts to load\",\n        position: 'topRight',\n        backgroundColor: '#f39c12',\n        messageColor: '#ffffff',\n        messageSize: '16px',\n        titleColor: '#ffffff',\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["markup","arr","webformatURL","tags","largeImageURL","likes","views","comments","downloads","API_KEY","fetchFoo","info","page","params","axios","form","gallery","loadBtn","lightbox","SimpleLightbox","showLoader","hideLoader","value","currentPage","perPage","event","data","iziToast","error","posts","totalPages","firstCard","cardHeight"],"mappings":"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"}